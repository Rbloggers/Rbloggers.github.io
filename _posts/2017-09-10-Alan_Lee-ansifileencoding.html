---
author: "Alan Lee"
title: "R讀取中文檔案產生亂碼等錯誤問題"
tags: ['data input', 'read', 'tutorials']
link: "http://rwepa.blogspot.com/2017/09/ansifileencoding.html"
highlight: true
---

主題: R讀取中文檔案產生亂碼等錯誤問題<br /><br />說明:<br /><br /># read.table<br /># encoding="UTF-8-BOM"<br /># ANSI<br /><ul><li>感謝R友-阿賢提供&nbsp;encoding="UTF-8-BOM"解決亂碼問題<span style="background-color: white; color: #222222; font-family: &quot;arial&quot; , sans-serif; font-size: 14px;">.</span></li><li>使用R讀取文字檔時, 有時會遇到資料匯入有錯誤訊息或中文亂碼問題.</li><li>資料來源:&nbsp;<a href="https://data.gov.tw/dataset/35131" target="_blank">https://data.gov.tw/dataset/35131</a>, 匯入 open data&nbsp;空氣品質監測小時值(一般污染物,每日更新) 所產生的問題與解決方式.</li><li>匯入資料 read.table {utils} 常用參數: <br />(1). fill = TRUE --&gt; 使用時機: 錯誤訊息為&nbsp;line x did not have xxx elements.<br />(2). encoding --&gt; 結果為亂碼.<br />(3). fileEncoding &nbsp;--&gt; 結果為亂碼.</li><li>考慮 Windows 執行環境, 如果有亂碼問題, 最簡單的解決方式之一是使用記事本開啟檔案, 另存新檔 畫面中, 編碼改為 ANSI.</li></ul><br /><div class="separator" style="clear: both; text-align: left;"><a href="https://2.bp.blogspot.com/-nF6ICBD2dBo/WbUSbwVEitI/AAAAAAAAL60/tdwpXFMWtEsuUIDPnBLXT2Kyn9jo339wQCLcBGAs/s1600/save_ansi.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1204" data-original-width="1511" height="317" src="https://2.bp.blogspot.com/-nF6ICBD2dBo/WbUSbwVEitI/AAAAAAAAL60/tdwpXFMWtEsuUIDPnBLXT2Kyn9jo339wQCLcBGAs/s400/save_ansi.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"></div><ul><li>使用 Notepad++ [<a href="https://notepad-plus-plus.org/zh/" target="_blank">https://notepad-plus-plus.org/zh/</a>] 開啟檔案, 在視窗右下角狀態列會有"UTF-8-BOM"編碼, 此時可加上 encoding 或 fileEncoding 參數, 本例使用&nbsp;fileEncoding = "UTF-8-BOM" 參數即可完成匯入資料.</li></ul><div><br /></div><div class="separator" style="clear: both; text-align: left;"><a href="https://4.bp.blogspot.com/-M40itjS5kJg/WbUVbK0plaI/AAAAAAAAL7A/_lXua1MExUYjcd_n4DIrKhwOcr0WivnuQCLcBGAs/s1600/open_utf8bom.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1011" data-original-width="1600" height="252" src="https://4.bp.blogspot.com/-M40itjS5kJg/WbUVbK0plaI/AAAAAAAAL7A/_lXua1MExUYjcd_n4DIrKhwOcr0WivnuQCLcBGAs/s400/open_utf8bom.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><ul><li>另可參考:&nbsp;資料集為CSV檔，打開來為亂碼，怎麼辦?&nbsp;<a href="https://data.gov.tw/node/18765" target="_blank">https://data.gov.tw/node/18765</a></li><li>結論: 使用另存<span style="background-color: #fff2cc;">ANSI</span>編碼或加入<span style="background-color: #fff2cc;">fileEncoding="UTF-8-BOM"</span>參數應該可以解決亂碼問題.</li></ul># 執行畫面:<br /><br /><div class="separator" style="clear: both; text-align: left;"><a href="https://3.bp.blogspot.com/-V5cC5CLlMPw/WbUbA5EDcdI/AAAAAAAAL7Q/ij1kGJG3Zw8ld4-LbVv2XSJZzRhYoNbawCLcBGAs/s1600/read.table.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1427" data-original-width="1600" height="356" src="https://3.bp.blogspot.com/-V5cC5CLlMPw/WbUbA5EDcdI/AAAAAAAAL7Q/ij1kGJG3Zw8ld4-LbVv2XSJZzRhYoNbawCLcBGAs/s400/read.table.png" width="400" /></a></div><br /><br /># R程式碼:<br /><pre><code class="language-r line-numbers">x1 &lt;- read.table("ATM00626_20170910170405.csv", header=TRUE, sep=",") # line 1 did not have 31 elements<br />x2 &lt;- read.table("ATM00626_20170910170405.csv", header=TRUE, sep=",", encoding="UTF-8") # line 1 did not have 31 elements<br />x3 &lt;- read.table("ATM00626_20170910170405.csv", header=TRUE, sep=",", encoding="UTF-8", fill=TRUE) # 欄位錯誤<br />x3[1:3, 1:6]<br />x4 &lt;- read.table("ATM00626_20170910170405.csv", header=TRUE, sep=",", encoding="UTF-8-BOM") # line 1 did not have 31 elements<br />x5 &lt;- read.table("ATM00626_20170910170405.csv", header=TRUE, sep=",", encoding="UTF-8-BOM", fill=TRUE) # 亂碼<br />x5[1:3, 1:6]<br />x6 &lt;- read.table("ATM00626_20170910170405.csv", header=TRUE, sep=",", fileEncoding = "UTF-8-BOM", fill=TRUE) # OK<br />x6[1:3, 1:6]<br />x7 &lt;- read.table("ATM00626_20170829185638-ansi.csv", header=TRUE, sep=",") # OK<br />x7[1:3, 1:6]<br />x8 &lt;- read.csv("ATM00626_20170910170405.csv", header=TRUE) # 亂碼<br />x8[1:3, 1:6]<br />x9 &lt;- read.csv("ATM00626_20170910170405.csv", header=TRUE, fileEncoding = "UTF-8") # invalid input found<br />x10 &lt;- read.csv("ATM00626_20170910170405.csv", header=TRUE, encoding = "UTF-8-BOM") # 亂碼<br />x10[1:3, 1:6]<br />x11 &lt;- read.csv("ATM00626_20170910170405.csv", header=TRUE, fileEncoding = "UTF-8-BOM") # OK<br />x11[1:3, 1:6]<br /># end</code></pre>