---
author: "Alan Lee"
title: "蒙地卡羅法估計圓周率 (Monte Carlo Estimation of pi)"
tags: ['Monte Carlo', 'pi', 'plot', 'plotrix', 'programming', 'simulation']
link: "http://rwepa.blogspot.com/2017/10/monte-carlo-estimation-of-pi.html"
---

# 蒙地卡羅法<br /># 圓周率<br /># 模擬<br />#&nbsp;Monte Carlo<br /># pi<br /># Simulation<br /># Programming<br /># plotrix package<br /><br /><h3>分析:</h3><ul><li><span style="font-family: &quot;arial&quot; , &quot;tahoma&quot; , &quot;helvetica&quot; , &quot;freesans&quot; , sans-serif;"><span style="font-size: 13.2px;">本範例使用蒙地卡羅法以估計圓周率 pi。<!--more--></span></span></li><li><span style="font-family: &quot;arial&quot; , &quot;tahoma&quot; , &quot;helvetica&quot; , &quot;freesans&quot; , sans-serif;"><span style="font-size: 13.2px;">考慮正方形邊長為單位1, 面積為1平方單位. 中間包括圓形, 其半徑為0.5單位，圓形面積 = pi*(0.5^2) = pi/4.</span></span></li><li><span style="font-family: &quot;arial&quot; , &quot;tahoma&quot; , &quot;helvetica&quot; , &quot;freesans&quot; , sans-serif;"><span style="font-size: 13.2px;">在正方形內隨機產生一個點(x, y), 點落在圓型內的機率大約等於扇型面積 / 正方形面積 = pi/4。</span></span></li><li><span style="font-family: &quot;arial&quot; , &quot;tahoma&quot; , &quot;helvetica&quot; , &quot;freesans&quot; , sans-serif;"><span style="font-size: 13.2px;">考慮(x,y)落在圓形中的次數有numberInCircle次, 全部實驗次數為N, 則 pi 大約等於: <br />(numberInCircle / N ) * 4.</span></span></li></ul><br /><div class="separator" style="clear: both; text-align: left;"><a href="https://4.bp.blogspot.com/-LMubOJzuz8o/WdriWmWz9ZI/AAAAAAAAL-8/5aCPGxhKeqw6Lj0S2KcnwggYltNm9KV_ACLcBGAs/s1600/pi-demo.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="662" data-original-width="654" height="320" src="https://4.bp.blogspot.com/-LMubOJzuz8o/WdriWmWz9ZI/AAAAAAAAL-8/5aCPGxhKeqw6Lj0S2KcnwggYltNm9KV_ACLcBGAs/s320/pi-demo.png" width="316" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><h3 style="clear: both; text-align: left;">R程式解說:</h3><ul><li>[#3] 首先載入 plotrix 套件, 準備繪製圓形圖.</li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#4] 設定亂數種子, 準備隨機產生資料點(x, y)</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#5] mfrow=c(1,2) 設定繪圖結果為1列2行</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#6] 設定 type="n" 表示不繪圖. 因後續須客製化座標軸, axes=FALSE 不繪製座標軸, asp=1設定長寬比例為1. main 標題使用 expression 以標示數學符號pi.</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#7] 使用 draw.circle {plotrix} 繪製圓形圖.</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#8] 使用 lines 繪製正外形.</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#9] 加上4個角落位置的座標軸.</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#11] 建立 pi.simulation 函數</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#16-18] 如果點(x, y) 與 (0.5, 0.5) 之距離小於或等於0.5, 表示此點位於圓形之內, 此時 numberInCircle 個數加上1, 繪製紅色點.</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#21] 點(x, y)不位於圓形內, 繪製藍色點.</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#23] 計算估計pi值並儲存於 c 物件.</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#25] 回傳估計pi值物件c.</span></li><li style="font-family: arial, tahoma, helvetica, freesans, sans-serif;"><span style="font-size: 13.2px;">[#30] 取出最後一次計算之估計pi值.</span></li><li><span style="font-family: arial, tahoma, helvetica, freesans, sans-serif; font-size: 13.2px;">[#39] 使用 par 函數將繪圖結果還原成1列,1行.</span></li></ul><h3>蒙地卡羅法估計圓周率圖:</h3><br /><div class="separator" style="clear: both; text-align: left;"><a href="https://4.bp.blogspot.com/-1YqxX8MQHno/WdrslhAR44I/AAAAAAAAL_M/88pTiAJdee8V3BOGk0E0ljSnuOd5_tuUgCLcBGAs/s1600/Monte%2BCarlo%2Bpi.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="794" data-original-width="1368" height="231" src="https://4.bp.blogspot.com/-1YqxX8MQHno/WdrslhAR44I/AAAAAAAAL_M/88pTiAJdee8V3BOGk0E0ljSnuOd5_tuUgCLcBGAs/s400/Monte%2BCarlo%2Bpi.png" width="400" /></a></div><br /><br /><h3>R程式:</h3><br /><br /><pre><code class="language-r line-numbers"># title: Monte Carlo Estiamtion of pi<br /># date: 2017.10.9<br />library(plotrix)<br />set.seed(123)<br />op &lt;- par(mfrow=c(1,2))<br />plot(0.5, 0.5, xlim=c(0, 1), ylim=c(0,1), type="n", axes=FALSE, asp=1, xlab="", ylab="", main=expression(paste("Monte Carlo for ", pi)))<br />draw.circle(0.5, 0.5, radius=0.5)<br />lines(x=c(0,1,1,0,0), y=c(0,0,1,1,0))<br />text(c(0.05,0.95,0.95,0.05), c(0.05,0.05,0.95,0.95), c("(0,0)", "(1,0)", "(1,1)", "(0,1)"))<br /><br />pi.simulation &lt;- function(samplesize) {<br /> c &lt;- rep(0, samplesize)<br /> numberInCircle &lt;- 0<br /> for (i in 1:samplesize) {<br /> x &lt;- runif(2)<br /> if (sqrt((x[1]-0.5)^2 + (x[2]-0.5)^2) &lt;= 0.5) {<br /> numberInCircle &lt;- numberInCircle + 1<br /> points(x[1], x[2], col="red", pch=".")<br /> }<br /> else {<br /> points(x[1], x[2], col="blue", pch=".")<br /> }<br /> c[i] &lt;- (numberInCircle / i) * 4<br /> }<br /> return(c)<br />}<br /><br />size &lt;- 10000<br />pi.sim &lt;- pi.simulation(size)<br />estimation.pi &lt;- pi.sim[size]<br />text(0.5, 0.5, paste0("sample size=", size), cex=1.5)<br />text(0.5, 0.4, paste("pi=",estimation.pi))<br />plot(pi.sim, type="l", <br /> main="Monte Carlo method for pi",<br /> xlab="samples", ylab=expression(paste("Estimation of ", pi)), <br /> ylim=c(0,6))<br />abline(h=estimation.pi, col="red", lty=3)<br />grid()<br />par(op)<br /># end<br /></code></pre><br />